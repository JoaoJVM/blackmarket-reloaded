define(["angular"],function(){var e={name:"BR-S",salt:"BRKey",saveInterval:undefined,save:function(e){var t={money:game.money,totalMoney:game.totalMoney,allTimeMoney:game.allTimeMoney,level:game.level,reputation:game.reputation,totalReputation:game.totalReputation,allTimeReputation:game.allTimeReputation,reputationNeed:game.reputationNeed,actionsProgress:game.actions.progress,actionsOwned:game.actions.owned,actionsRewardMultiplier:game.actions.rewardMultiplier,actionsTotalRewardMultiplier:game.actions.totalRewardMultiplier,actionsTimeMultiplier:game.actions.timeMultiplier,actionsTotalTimeMultiplier:game.actions.totalTimeMultiplier,actionsCurrentRep:game.actions.currentRep,researchActionsBought:game.research.actions.bought,collectionsOwned:game.collections.owned,optionsBefore:game.options.before,optionsFirstTime:game.options.firstTime,optionsVersion:game.options.version,optionsStarted:game.options.started};game.options.init&&localStorage.setItem(this.name+this.salt,JSON.stringify(t)),e=="user"&&notify.pop("success","Game successfully saved!"),e!=="silent"&&log("Game saved.")},load:function(e){if(localStorage.getItem(this.name+this.salt)===null)notify.pop("alert","No save found!");else{var t=JSON.parse(localStorage.getItem(this.name+this.salt));game.money=t.money,game.totalMoney=t.totalMoney,game.allTimeMoney=t.allTimeMoney,game.level=t.level,game.reputation=t.reputation,game.totalReputation=t.totalReputation,game.allTimeReputation=t.allTimeReputation,game.reputationNeed=t.reputationNeed,game.actions.progress=t.actionsProgress,game.actions.owned=t.actionsOwned,game.actions.rewardMultiplier=t.actionsRewardMultiplier,game.actions.totalRewardMultiplier=t.actionsTotalRewardMultiplier,game.actions.timeMultiplier=t.actionsTimeMultiplier,game.actions.totalTimeMultiplier=t.actionsTotalTimeMultiplier,game.actions.currentRep=t.actionsCurrentRep,game.research.actions.bought=t.researchActionsBought,game.options.before=t.optionsBefore,game.options.firstTime=t.optionsFirstTime,game.options.started=t.optionsStarted,game.collections.owned=t.collectionsOwned,this.saveChecker(),game.research.display(),e=="user"&&notify.pop("success","Save-game successfully loaded!"),e!=="silent"&&log("Savegame loaded.")}},saveChecker:function(){var e=JSON.parse(localStorage.getItem(game.save.name+game.save.salt)),t=this.save.saveInterval;if(e.optionsVersion!==game.options.version){warn("Loading old savegame, the save may be corrupted.\nOld : v"+e.optionsVersion+" - current : v"+game.options.version);for(var n in game)typeof game[n]!="object"&&typeof game[n]!="function"&&(game[n]==null||game[n]==undefined||isNaN(game[n])==1)&&(warn("bug for "+n),game[n]=0);for(var n in game.actions)typeof game.actions[n]!="object"&&typeof game.actions[n]!="function"&&(game.actions[n]==null||game.actions[n]==undefined||isNaN(game.actions[n])==1)&&(warn("bug for "+n),game.actions[n]=0);for(var n in game.achievements)typeof game.achievements[n]!="object"&&typeof game.achievements[n]!="function"&&(game.achievements[n]==null||game.achievements[n]==undefined||isNaN(game.achievements[n])==1)&&(warn("bug for "+n),game.achievements[n]=0);for(var n in game.collections)typeof game.collections[n]!="object"&&typeof game.collections[n]!="function"&&(game.collections[n]==null||game.collections[n]==undefined||isNaN(game.collections[n])==1)&&(warn("bug for "+n),game.collections[n]=0);for(var n in game.research.actions)typeof game.research.actions[n]!="object"&&typeof game.research.actions[n]!="function"&&(game.research.actions[n]==null||game.research.actions[n]==undefined||isNaN(game.research.actions[n])==1)&&(warn("bug for "+n),game.research.actions[n]=0)}},eventListenerSave:function(){game.save.save()},reset:function(e,t){var n=this.save.saveInterval;$("#options-reset").html("Really?"),$("#options-yes, #options-no").show(),$("#options-reset").addClass("really"),e&&(window.clearInterval(n),window.removeEventListener("beforeunload",game.save.eventListenerSave,!1),localStorage.removeItem(this.name+this.salt),window.history.pushState("","","/#/"),window.location.reload()),t&&($("#options-reset").html("Hard-reset"),$("#options-yes, #options-no").hide(),$("#options-reset").removeClass("really"))},devReset:function(){var e=this.save.saveInterval;window.clearInterval(e),window.removeEventListener("beforeunload",game.save.eventListenerSave,!1),localStorage.removeItem(this.name+this.salt),window.history.pushState("","","/#/"),window.location.reload()},setInt:function(){this.saveInterval=window.setInterval(function(){game.save.save()},1e3),log("Save interval set - ID "+this.saveInterval)},removeInt:function(){var e=this.saveInterval;window.clearInterval(e),log("Save interval removed.")},init:function(){this.setInt(),window.game.save=this,window.addEventListener("beforeunload",game.save.eventListenerSave,!1),log("Save init.")}};return e.init()});